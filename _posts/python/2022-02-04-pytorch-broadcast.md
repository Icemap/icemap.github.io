---
layout: single
title:  "pytorch å¹¿æ’­æœºåˆ¶"
date:   2022-02-04 16:20:51 +0800
categories:
  - python grammer
tags:
  - è¯­æ³•
---

# pytorch å¹¿æ’­æœºåˆ¶

- pytorchçš„å¹¿æ’­æœºåˆ¶ï¼Œæœ¬è´¨ä¸Šå°±æ˜¯åˆ©ç”¨è¿ç®—ç¬¦é‡è½½ï¼Œé’ˆå¯¹åŸæœ¬ä¸æ”¯æŒè®¡ç®—çš„ä¸€ç§æƒ…å†µ: `ä¸åŒå½¢çŠ¶çš„å‘é‡çš„äº’æ“ä½œ`è¿›è¡Œäº†æ‹“å±•
- è¿™ç§æ‹“å±•æé«˜äº†æ€§èƒ½ï¼Œå› ä¸ºå¯ä»¥ä¸€æ¬¡æ€§å°†å˜é‡æäº¤è‡³C/C++è¯­è¨€å±‚ï¼Œå‡å°‘äº†Pythonå’ŒC/C++çš„äº¤äº’
- è¿™ç§æ‹“å±•æé«˜äº†ä»£ç çš„ç®€æ´ç¨‹åº¦ï¼Œä¸€å®šç¨‹åº¦ä¸Šå‡å°‘äº†ç¨‹åºå‘˜çš„å¿ƒæ™ºè´Ÿæ‹…
- ä½†ä¹Ÿæé«˜äº†å‡ºé”™çš„å¯èƒ½æ€§ï¼Œå› ä¸ºå¹¿æ’­çš„å­˜åœ¨ï¼Œå°†fast-failedæœºåˆ¶ç ´åäº†
- å› æ­¤éœ€ä»”ç»†ç ”ç©¶å¹¿æ’­æœºåˆ¶ï¼Œä»¥å…è¿‡å¤šçš„ç¼–ç é”™è¯¯

## æ»¡è¶³å¹¿æ’­æœºåˆ¶çš„æ¡ä»¶

- ä¸¤å¼ é‡å½¢çŠ¶ä¸åŒ
- å½¢çŠ¶ä¸åŒçš„ç»´åº¦ï¼Œè‡³å°‘æœ‰ä¸€æ–¹çš„ç»´åº¦ä¸º1


# ä¸¾å‡ ä¸ªğŸŒ°

## 1. éå¹¿æ’­æœºåˆ¶

- å•çº¯å°±æ˜¯ä¸¤ä¸ªå¼ é‡çš„å¯¹åº”æ•°å­—ç›´æ¥æ“ä½œï¼ˆç›¸ä¹˜ï¼‰

```python
import torch

print("normal calculator")
tensor_a = torch.tensor([[1, 2, 3], [4, 5, 6]])
print(f"tensor_a:\n{tensor_a}")
tensor_b = torch.tensor([[2, 3, 4], [5, 6, 7]])
print(f"tensor_b:\n{tensor_b}")
print(f"result:\n{tensor_a * tensor_b}")
```

- è¿è¡Œç»“æœ

```
normal calculator
tensor_a:
tensor([[1, 2, 3],
        [4, 5, 6]])
tensor_b:
tensor([[2, 3, 4],
        [5, 6, 7]])
result:
tensor([[ 2,  6, 12],
        [20, 30, 42]])
```


## 2. ä¸€ä¸ªå¼ é‡ä¸å¦ä¸€ä¸ªå¼ é‡çš„ååŠéƒ¨åˆ†ç»´åº¦ç›¸åŒ

- è¿™ç§æƒ…å†µæ˜¯`å½¢çŠ¶ä¸åŒçš„ç»´åº¦ï¼Œè‡³å°‘æœ‰ä¸€æ–¹çš„ç»´åº¦ä¸º1`çš„ä¸€ç§ç‰¹æ®Šæƒ…å†µï¼Œå®ƒçš„æ‰€æœ‰1ç»´åº¦ï¼Œéƒ½æ˜¯ç”±ç»´åº¦è¾ƒä½çš„å¼ é‡æä¾›çš„
- æ¯”å¦‚ï¼š`tensor(2,3,2)`ä¸`tensor(3,2)`,`tensor(3,2)`æ˜¯`tensor(2,3,2)`çš„ååŠéƒ¨åˆ†
- å®é™…ä¸Šï¼Œå¯ä»¥è¢«å†™æˆ`tensor(2,3,2)`ä¸`tensor(1,3,2)`ï¼Œå®é™…ä¸Šæ˜¯ç”±`tensor(1,3,2)`æä¾›äº†ç¬¬ä¸€ä¸ªç»´åº¦ä¸åŒæ—¶çš„`ä¸€æ–¹ç»´åº¦ä¸º1`çš„æ¡ä»¶

```python
import torch

print("front broadcast")
tensor_a = torch.tensor(
    [[[1, 2], [3, 4], [5, 6]], [[1, 2], [3, 4], [5, 6]]]
)
print(f"tensor_a shape:\n{tensor_a.shape}")

tensor_b = torch.tensor(
    [[2, 3], [4, 5], [6, 7]]
)
print(f"tensor_b shape:\n{tensor_b.shape}")

result = tensor_a * tensor_b
print(f"result shape:\n{result.shape}")
print(f"result:\n{result}")
```

- è¿è¡Œç»“æœ
```
front broadcast
tensor_a shape:
torch.Size([2, 3, 2])
tensor_b shape:
torch.Size([3, 2])
result shape:
torch.Size([2, 3, 2])
result:
tensor([[[ 2,  6],
         [12, 20],
         [30, 42]],

        [[ 2,  6],
         [12, 20],
         [30, 42]]])
```

- å¯ä»¥çœ‹åˆ°ï¼Œæ“ä½œç¬¦æ˜¯å°†æ‰€æœ‰çš„åå‘å…ƒç´ ï¼Œé€ä¸€åŒ¹é…åˆ°å‰å‘å…ƒç´ ä¸Šï¼Œmatchæˆä¸ºä¸€ä¸ªå‰å‘å…ƒç´ çš„å­é›†ï¼Œè¿›è¡Œæ“ä½œçš„
- è¿™æ ·å¯ä»¥åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ›¿ä»£å¾ªç¯æ“ä½œï¼Œé˜²æ­¢å¤§é‡çš„è·¨è¯­è¨€äº¤äº’

## 3. æ¨å¹¿åˆ°ä¸€èˆ¬æƒ…å†µ

- è¿™æ—¶ï¼Œæˆ‘ä»¬è€ƒè™‘æ¨å¹¿åˆ°ä¸€èˆ¬æƒ…å†µï¼Œå³`å½¢çŠ¶ä¸åŒçš„ç»´åº¦ï¼Œè‡³å°‘æœ‰ä¸€æ–¹çš„ç»´åº¦ä¸º1`çš„å…¨éƒ¨æƒ…å†µ
- å‡è®¾è¿™ä¸ªå½¢çŠ¶ä¸åŒçš„ç»´åº¦ï¼Œå‡ºç°åœ¨ä¸­é—´ï¼Œè€Œä¸æ˜¯å‰ä¾§ï¼Œå°†ä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µï¼Ÿ

```python
import torch

print("normal broadcast")
tensor_a = torch.tensor(
    [[[1, 2], [3, 4], [5, 6]], [[3, 4], [5, 6], [7, 8]]]
)
print(f"tensor_a shape:\n{tensor_a.shape}")

tensor_b = torch.tensor(
    [[[2, 3]], [[4, 5]]]
)
print(f"tensor_b shape:\n{tensor_b.shape}")

result = tensor_a * tensor_b
print(f"result shape:\n{result.shape}")
print(f"result:\n{result}")
```

- è¿è¡Œç»“æœ
```
normal broadcast
tensor_a shape:
torch.Size([2, 3, 2])
tensor_b shape:
torch.Size([2, 1, 2])
result shape:
torch.Size([2, 3, 2])
result:
tensor([[[ 2,  6],
         [ 6, 12],
         [10, 18]],

        [[12, 20],
         [20, 30],
         [28, 40]]])
```

- å¯ä»¥çœ‹åˆ°ï¼Œå¹¿æ’­æœºåˆ¶å¤åˆ¶äº†`[[[2, 3]], [[4, 5]]]`ï¼Œç­‰æ•ˆäº`[[[2, 3], [2, 3], [2, 3]], [[4, 5], [4, 5], [4, 5]]]`
- æŠŠç»´åº¦æ¯”åšä¸€é¢—æ ‘çš„è¯ï¼Œé‚£ä¹ˆå°±æ˜¯è¿›è¡Œäº†ä¸€æ¬¡æ·±åº¦ä¼˜å…ˆçš„***ååºéå†***ï¼Œæ‰©æ•£äº†å½“å‰èŠ‚ç‚¹çš„å€¼